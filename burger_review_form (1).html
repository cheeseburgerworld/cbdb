<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit a Burger Review - CB⚡DB</title>
    <style>
        @font-face {
            font-family: 'ChicagoFLF';
            src: url('https://cdnjs.cloudflare.com/ajax/libs/Chicago-Font/1.0.0/ChicagoFLF.ttf') format('truetype');
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'ChicagoFLF', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 2px, transparent 2px),
                radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 2px, transparent 2px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #f0f0f0;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .header {
            background: linear-gradient(to bottom, #e0e0e0, #c0c0c0);
            padding: 20px 30px;
            border-bottom: 2px solid #999;
        }

        .header h1 {
            font-size: 24px;
            color: #333;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 12px;
            color: #666;
            line-height: 1.5;
        }

        .form-content {
            background: white;
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #4a90e2;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: bold;
            color: #333;
        }

        .required {
            color: #e74c3c;
            margin-left: 3px;
        }

        .form-group input[type="text"],
        .form-group input[type="date"],
        .form-group input[type="email"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            line-height: 1.5;
        }

        .helper-text {
            font-size: 11px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .char-counter {
            font-size: 11px;
            color: #999;
            text-align: right;
            margin-top: 5px;
        }

        .char-counter.warning {
            color: #f39c12;
        }

        .char-counter.maxed {
            color: #e74c3c;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Rating Slider Styling */
        .rating-group {
            margin-bottom: 25px;
        }

        .rating-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .rating-label span {
            font-size: 13px;
            font-weight: bold;
        }

        .rating-value {
            font-size: 20px;
            font-weight: bold;
            color: #4a90e2;
            min-width: 50px;
            text-align: right;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4a90e2;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4a90e2;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Photo Upload Styling */
        .photo-upload {
            border: 3px dashed #ddd;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            background: #fafafa;
            transition: all 0.3s;
            cursor: pointer;
        }

        .photo-upload:hover {
            border-color: #4a90e2;
            background: #f0f8ff;
        }

        .photo-upload.active {
            border-color: #4a90e2;
            background: #f0f8ff;
        }

        .photo-upload input[type="file"] {
            display: none;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .upload-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .upload-subtext {
            font-size: 11px;
            color: #999;
        }

        .image-preview {
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
            display: none;
        }

        .image-preview img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Style Categories Info */
        .style-info {
            background: #f9f9f9;
            border-left: 4px solid #4a90e2;
            padding: 12px 15px;
            margin-top: 10px;
            border-radius: 4px;
            font-size: 11px;
            color: #666;
            line-height: 1.6;
        }

        .style-info strong {
            color: #333;
            display: block;
            margin-bottom: 5px;
        }

        /* Submit Button */
        .submit-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(to bottom, #4a90e2, #357abd);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .submit-btn:hover {
            background: linear-gradient(to bottom, #357abd, #2868a8);
            box-shadow: 0 6px 16px rgba(74, 144, 226, 0.4);
            transform: translateY(-2px);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-note {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 12px;
            line-height: 1.5;
        }

        .submit-note strong {
            display: block;
            margin-bottom: 5px;
            color: #856404;
        }

        /* Success Message */
        .success-message {
            display: none;
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
        }

        .success-message.show {
            display: block;
        }

        .success-icon {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .success-message h2 {
            color: #155724;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .success-message p {
            color: #155724;
            font-size: 13px;
            line-height: 1.6;
        }

        .back-link {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 13px;
        }

        .upload-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
            font-size: 12px;
            text-align: center;
            display: none;
        }

        .upload-status.uploading {
            display: block;
            background: #e3f2fd;
            color: #1976d2;
            border: 1px solid #90caf9;
        }

        .upload-status.success {
            display: block;
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #81c784;
        }

        .upload-status.error {
            display: block;
            background: #ffebee;
            color: #c62828;
            border: 1px solid #e57373;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🍔 Submit a Burger Review</h1>
            <p>Share your burger experience with the CB⚡DB community. All submissions are reviewed by our team before going live.</p>
        </div>

        <div class="form-content">
            <div class="success-message" id="successMessage">
                <div class="success-icon">✅</div>
                <h2>Review Submitted Successfully!</h2>
                <p>Thank you for your contribution! Your review has been submitted and will be reviewed by our team. We'll notify you once it's approved and live on the site.</p>
                <a href="#" class="back-link" onclick="resetForm(); return false;">Submit Another Review</a>
            </div>

            <form id="burgerReviewForm" name="burger-review" method="POST" data-netlify="true" onsubmit="handleSubmit(event)">
                <!-- Basic Info Section -->
                <div class="section">
                    <div class="section-title">📍 Basic Information</div>
                    
                    <div class="form-group">
                        <label for="restaurantName">Restaurant Name<span class="required">*</span></label>
                        <input type="text" id="restaurantName" name="restaurantName" required placeholder="Shake Shack, In-N-Out">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">City<span class="required">*</span></label>
                            <input type="text" id="city" name="city" required placeholder="Portland">
                        </div>
                        <div class="form-group">
                            <label for="state">State<span class="required">*</span></label>
                            <input type="text" id="state" name="state" required placeholder="OR" maxlength="2">
                            <div class="helper-text">Two-letter state code</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="visitDate">Visit Date<span class="required">*</span></label>
                            <input type="date" id="visitDate" name="visitDate" required>
                        </div>
                        <div class="form-group">
                            <label for="price">Price Range<span class="required">*</span></label>
                            <select id="price" name="price" required>
                                <option value="">Select price range</option>
                                <option value="$">$ (Under $10)</option>
                                <option value="$">$ ($10-17)</option>
                                <option value="$$">$$ (Over $17)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="style">Burger Style<span class="required">*</span></label>
                        <select id="style" name="style" required onchange="showStyleInfo(this.value)">
                            <option value="">Select a style</option>
                            <option value="Classic">Classic</option>
                            <option value="Fast Food">Fast Food</option>
                            <option value="Pub">Pub</option>
                            <option value="Gourmet">Gourmet</option>
                            <option value="Smash">Smash</option>
                            <option value="Sliders">Sliders</option>
                            <option value="Speciality/Regional">Specialty/Regional</option>
                        </select>
                        <div id="styleInfo" class="style-info" style="display: none;"></div>
                    </div>
                </div>

                <!-- Photo Section -->
                <div class="section">
                    <div class="section-title">📸 Photo Upload</div>
                    
                    <div class="form-group">
                        <label onclick="document.getElementById('photoUpload').click()" class="photo-upload" id="photoUploadArea">
                            <input type="file" id="photoUpload" accept="image/*" required onchange="handlePhotoUpload(event)">
                            <div class="upload-icon">📷</div>
                            <div class="upload-text">Click to upload your burger photo</div>
                            <div class="upload-subtext">Required • JPG, PNG, or HEIC • Max 10MB</div>
                        </label>
                        <input type="hidden" id="photoUrl" name="photoUrl" required>
                        <div class="image-preview" id="imagePreview">
                            <img id="previewImg" src="" alt="Preview">
                        </div>
                        <div class="upload-status" id="uploadStatus"></div>
                        <div class="helper-text">Pro tip: Natural lighting works best! Capture the burger from a slight angle.</div>
                    </div>
                </div>

                <!-- Ratings Section -->
                <div class="section">
                    <div class="section-title">⭐ Ratings</div>
                    
                    <div class="rating-group">
                        <div class="rating-label">
                            <span>Overall Score<span class="required">*</span></span>
                            <span class="rating-value" id="overallValue">7</span>
                        </div>
                        <input type="range" id="overall" name="overall" min="1" max="10" value="7" required oninput="updateRating('overall', this.value)">
                        <div class="helper-text">Your overall impression of the entire burger experience</div>
                    </div>

                    <div class="rating-group">
                        <div class="rating-label">
                            <span>Burger Quality<span class="required">*</span></span>
                            <span class="rating-value" id="burgerValue">7</span>
                        </div>
                        <input type="range" id="burger" name="burger" min="1" max="10" value="7" required oninput="updateRating('burger', this.value)">
                        <div class="helper-text">Patty quality, toppings, bun</div>
                    </div>

                    <div class="rating-group">
                        <div class="rating-label">
                            <span>Sides<span class="required">*</span></span>
                            <span class="rating-value" id="sidesValue">7</span>
                        </div>
                        <input type="range" id="sides" name="sides" min="1" max="10" value="7" required oninput="updateRating('sides', this.value)">
                        <div class="helper-text">Fries, onion rings, or other accompaniments</div>
                    </div>

                    <div class="rating-group">
                        <div class="rating-label">
                            <span>Value<span class="required">*</span></span>
                            <span class="rating-value" id="valueValue">7</span>
                        </div>
                        <input type="range" id="value" name="value" min="1" max="10" value="7" required oninput="updateRating('value', this.value)">
                        <div class="helper-text">Price relative to quality and portion size</div>
                    </div>

                    <div class="rating-group">
                        <div class="rating-label">
                            <span>Experience<span class="required">*</span></span>
                            <span class="rating-value" id="experienceValue">7</span>
                        </div>
                        <input type="range" id="experience" name="experience" min="1" max="10" value="7" required oninput="updateRating('experience', this.value)">
                        <div class="helper-text">Service, atmosphere, cleanliness, overall vibe</div>
                    </div>
                </div>

                <!-- Review Notes Section -->
                <div class="section">
                    <div class="section-title">📝 Your Review</div>
                    
                    <div class="form-group">
                        <label for="notes">Review Notes<span class="required">*</span></label>
                        <textarea id="notes" name="notes" required minlength="100" maxlength="400" placeholder="Share your detailed thoughts about this burger. What made it memorable? How was the patty cooked? Were the toppings fresh? Would you recommend it?" oninput="updateCharCount()"></textarea>
                        <div class="char-counter" id="charCounter">0/400 characters (minimum 100)</div>
                        <div class="helper-text">Be specific! Mention the burger quality, toppings, bun, and what made it stand out.</div>
                    </div>
                </div>

                <!-- Optional Info Section -->
                <div class="section">
                    <div class="section-title">👤 Your Info (Optional)</div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reviewerName">Display Name</label>
                            <input type="text" id="reviewerName" name="reviewerName" placeholder="How should we credit you?">
                            <div class="helper-text">Leave blank to remain anonymous</div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" placeholder="For approval notification">
                            <div class="helper-text">We'll notify you when your review goes live</div>
                        </div>
                    </div>
                </div>

                <!-- Submit Section -->
                <div class="submit-section">
                    <div class="submit-note">
                        <strong>📋 Before You Submit:</strong>
                        All reviews are manually reviewed to ensure quality and authenticity. Your submission will be checked for completeness, photo quality, and adherence to community guidelines. Approved reviews typically go live within 24-48 hours.
                    </div>
                    <button type="submit" class="submit-btn">Submit Review for Approval</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const styleDescriptions = {
            'Classic': 'Traditional burgers from diners, drive-ins, and local spots.',
            'Fast Food': 'Drive-thru chains or counter-service places with quick, affordable burgers.',
            'Pub': 'Bar-focused establishments with hearty burgers.',
            'Gourmet': 'Premium burgers with high-quality or creative toppings.',
            'Smash': 'Thin, crispy-edged patties smashed on a griddle.',
            'Sliders': 'Small, snack-sized burgers typically 2-3 bites each.',
            'Specialty/Regional': 'Unique local or concept-driven burgers - from Jucy Lucy to Butter Burgers.',
        };

        function showStyleInfo(style) {
            const infoDiv = document.getElementById('styleInfo');
            if (style && styleDescriptions[style]) {
                infoDiv.innerHTML = `<strong>${style}:</strong> ${styleDescriptions[style]}`;
                infoDiv.style.display = 'block';
            } else {
                infoDiv.style.display = 'none';
            }
        }

        function updateRating(type, value) {
            document.getElementById(type + 'Value').textContent = value;
        }

        function updateCharCount() {
            const textarea = document.getElementById('notes');
            const counter = document.getElementById('charCounter');
            const length = textarea.value.length;
            const min = 100;
            const max = 400;
            
            counter.textContent = `${length}/${max} characters`;
            
            if (length < min) {
                counter.textContent += ` (minimum ${min})`;
                counter.className = 'char-counter';
            } else if (length >= max - 50) {
                counter.className = 'char-counter warning';
            } else {
                counter.className = 'char-counter';
            }
            
            if (length === max) {
                counter.className = 'char-counter maxed';
            }
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Validate file size (10MB max)
            if (file.size > 10 * 1024 * 1024) {
                showUploadStatus('error', 'File too large! Please choose an image under 10MB.');
                event.target.value = '';
                return;
            }

            // Validate file type
            if (!file.type.startsWith('image/')) {
                showUploadStatus('error', 'Please upload an image file (JPG, PNG, or HEIC).');
                event.target.value = '';
                return;
            }

            const uploadArea = document.getElementById('photoUploadArea');
            const preview = document.getElementById('imagePreview');
            const previewImg = document.getElementById('previewImg');
            
            uploadArea.classList.add('active');
            
            // Show preview
            const reader = new FileReader();
            reader.onload = function(e) {
                previewImg.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);

            // Upload to Imgur
            uploadToImgur(file);
        }

        function uploadToImgur(file) {
            showUploadStatus('uploading', '📤 Uploading image...');

            const formData = new FormData();
            formData.append('image', file);

            fetch('https://api.imgur.com/3/image', {
                method: 'POST',
                headers: {
                    'Authorization': 'Client-ID 534b9f30d1d3e26' // Imgur anonymous upload client ID (public, safe to expose)
                },
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const imageUrl = data.data.link;
                    document.getElementById('photoUrl').value = imageUrl;
                    showUploadStatus('success', '✅ Image uploaded successfully!');
                    console.log('Image uploaded to:', imageUrl);
                } else {
                    throw new Error('Upload failed');
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showUploadStatus('error', '❌ Upload failed. Please try again or use a different image.');
                document.getElementById('photoUpload').value = '';
            });
        }

        function showUploadStatus(type, message) {
            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.className = `upload-status ${type}`;
            statusDiv.textContent = message;
        }

        function handleSubmit(event) {
            event.preventDefault();
            
            // Check if image has been uploaded
            const photoUrl = document.getElementById('photoUrl').value;
            if (!photoUrl) {
                showUploadStatus('error', '⚠️ Please wait for the image to finish uploading before submitting.');
                return false;
            }

            // Submit the form to Netlify
            const form = event.target;
            const formData = new FormData(form);

            fetch('/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams(formData).toString()
            })
            .then(() => {
                // Show success message
                document.getElementById('burgerReviewForm').style.display = 'none';
                document.getElementById('successMessage').classList.add('show');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            })
            .catch(error => {
                console.error('Form submission error:', error);
                alert('There was an error submitting your review. Please try again.');
            });

            return false;
        }

        function resetForm() {
            document.getElementById('successMessage').classList.remove('show');
            document.getElementById('burgerReviewForm').style.display = 'block';
            document.getElementById('burgerReviewForm').reset();
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('styleInfo').style.display = 'none';
            document.getElementById('photoUrl').value = '';
            document.getElementById('uploadStatus').className = 'upload-status';
            updateCharCount();
            
            // Reset all rating displays
            ['overall', 'burger', 'sides', 'value', 'experience'].forEach(type => {
                document.getElementById(type + 'Value').textContent = '7';
            });
        }

        // Set max date to today
        document.getElementById('visitDate').max = new Date().toISOString().split('T')[0];
    </script>
</body>
</html>